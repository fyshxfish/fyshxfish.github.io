<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content=" Semantics of let Key point: A let scope is evaluated immediately (including both bindings and expressions after bindings, i.e., everything within the outer parentheses of the let), even if the let is nested inside an inner function that hasn&rsquo;t been called yet.\nExample:\n(define (comp x) (if (&gt; 3 x) (display &#34;then-clause&#34;) (display &#34;else-clause&#34;) ) #| (define foo1 (let ((bar1 (/ 2 0))) ; * evaluted immediately (display &#34;should not be printed&#34;) ) ) |# (define foo2 (let ((bar2 (/ 5 2))) ; * evaluted immediately (newline) (display &#34;let in `foo2`, bar2: &#34;) (display bar2) ) ) ) Running examples:\n">
<title>Semantics of `let` in Scheme(feat. Semantics of `if`)</title>

<link rel='canonical' href='http://fyshxfish.github.io/p/semantics-of-let-in-schemefeat.-semantics-of-if/'>

<link rel="stylesheet" href="/scss/style.min.ca8e73f914c0e48d09b6dc36c97037f15a283dbaba328e73f133fd9c13b277ad.css"><meta property='og:title' content="Semantics of `let` in Scheme(feat. Semantics of `if`)">
<meta property='og:description' content=" Semantics of let Key point: A let scope is evaluated immediately (including both bindings and expressions after bindings, i.e., everything within the outer parentheses of the let), even if the let is nested inside an inner function that hasn&rsquo;t been called yet.\nExample:\n(define (comp x) (if (&gt; 3 x) (display &#34;then-clause&#34;) (display &#34;else-clause&#34;) ) #| (define foo1 (let ((bar1 (/ 2 0))) ; * evaluted immediately (display &#34;should not be printed&#34;) ) ) |# (define foo2 (let ((bar2 (/ 5 2))) ; * evaluted immediately (newline) (display &#34;let in `foo2`, bar2: &#34;) (display bar2) ) ) ) Running examples:\n">
<meta property='og:url' content='http://fyshxfish.github.io/p/semantics-of-let-in-schemefeat.-semantics-of-if/'>
<meta property='og:site_name' content='fyshXplore'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='SICP' /><meta property='article:tag' content='Scheme' /><meta property='article:published_time' content='2024-08-29T00:00:00&#43;08:00'/><meta property='article:modified_time' content='2024-08-29T00:00:00&#43;08:00'/>
<meta name="twitter:title" content="Semantics of `let` in Scheme(feat. Semantics of `if`)">
<meta name="twitter:description" content=" Semantics of let Key point: A let scope is evaluated immediately (including both bindings and expressions after bindings, i.e., everything within the outer parentheses of the let), even if the let is nested inside an inner function that hasn&rsquo;t been called yet.\nExample:\n(define (comp x) (if (&gt; 3 x) (display &#34;then-clause&#34;) (display &#34;else-clause&#34;) ) #| (define foo1 (let ((bar1 (/ 2 0))) ; * evaluted immediately (display &#34;should not be printed&#34;) ) ) |# (define foo2 (let ((bar2 (/ 5 2))) ; * evaluted immediately (newline) (display &#34;let in `foo2`, bar2: &#34;) (display bar2) ) ) ) Running examples:\n"><style>
  :root {
     
    --zh-font-family: "Noto Serif SC";
     
     
     
    --code-font-family: Consolas, Menlo, Monaco, "Courier New", var(--zh-font-family), monospace;
    --article-font-family: "Noto Serif SC";
  }
</style>

<script>
  (function () {
    const customFont = document.createElement("link");
    customFont.href =
      "https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap";

    customFont.type = "text/css";
    customFont.rel = "stylesheet";

    document.head.appendChild(customFont);
  })();
</script>


<link href="https://fonts.googleapis.com/css2?family=IM+Fell+English+SC&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=IM+Fell+Double+Pica+SC&display=swap" rel="stylesheet">


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            localStorage.setItem(colorSchemeKey, "auto");
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/fyshx_avatar_hu_4b64fe58c612edf3.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ðŸ«§</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">fyshXplore</a></h1>
            <h2 class="site-description">Wait for it...</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/fyshxfish'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-infinity" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M9.828 9.172a4 4 0 1 0 0 5.656 a10 10 0 0 0 2.172 -2.828a10 10 0 0 1 2.172 -2.828 a4 4 0 1 1 0 5.656a10 10 0 0 1 -2.172 -2.828a10 10 0 0 0 -2.172 -2.828" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">
                    
                        <li id="i18n-switch">  
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                            <select name="language" title="language" onchange="window.location.href = this.selectedOptions[0].value">
                                
                                    <option value="http://fyshxfish.github.io/zh/" >ä¸­æ–‡</option>
                                
                                    <option value="http://fyshxfish.github.io/" selected>English</option>
                                
                            </select>
                        </li>
                    
                

                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">&thinsp;Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#semantics-of-let">Semantics of <code>let</code></a></li>
    <li><a href="#semantics-of-if">Semantics of <code>if</code></a></li>
    <li><a href="#an-error-caused-by-immediate-let-evaluation">An Error Caused by Immediate <code>let</code> Evaluation</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/fp/" style="background-color: #b7c9e2; color: #fff;">
                FP
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/semantics-of-let-in-schemefeat.-semantics-of-if/">Semantics of `let` in Scheme(feat. Semantics of `if`)</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Aug 29, 2024</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    3 minute read
                </time>
            </div>
        
    </footer>
    

    
        <footer class="article-translations">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



            <div>
                
                    <a href="http://fyshxfish.github.io/zh/p/scheme-let-%E7%9A%84%E8%AF%AD%E4%B9%89-feat.-if-%E7%9A%84%E8%AF%AD%E4%B9%89/" class="link">ä¸­æ–‡</a>
                
            </div>
        </footer>
    
</div>

</header>

    <section class="article-content">
    
    
    <hr>
<h2 id="semantics-of-let"><a href="#semantics-of-let" class="header-anchor"></a>Semantics of <code>let</code>
</h2><p><mark>Key point</mark>: A <code>let</code> scope is evaluated immediately (including both bindings and expressions after bindings, i.e., everything within the outer parentheses of the <code>let</code>), even if the <code>let</code> is nested inside an inner function that hasn&rsquo;t been called yet.</p>
<p>Example:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span><span style="color:#1f2328">(</span><span style="color:#cf222e">define </span><span style="color:#1f2328">(</span><span style="color:#6639ba">comp</span> <span style="color:#953800">x</span><span style="color:#1f2328">)</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#1f2328">(</span><span style="color:#cf222e">if </span><span style="color:#1f2328">(</span><span style="color:#6639ba">&gt; </span><span style="color:#0550ae">3</span> <span style="color:#953800">x</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#1f2328">(</span><span style="color:#6639ba">display </span><span style="color:#0a3069">&#34;then-clause&#34;</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#1f2328">(</span><span style="color:#6639ba">display </span><span style="color:#0a3069">&#34;else-clause&#34;</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57606a">#|
</span></span></span><span style="display:flex;"><span><span style="color:#57606a">    (define foo1
</span></span></span><span style="display:flex;"><span><span style="color:#57606a">        (let ((bar1 (/ 2 0)))    ; * evaluted immediately
</span></span></span><span style="display:flex;"><span><span style="color:#57606a">            (display &#34;should not be printed&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#57606a">        )
</span></span></span><span style="display:flex;"><span><span style="color:#57606a">    )
</span></span></span><span style="display:flex;"><span><span style="color:#57606a">|#</span>
</span></span><span style="display:flex;"><span>    <span style="color:#1f2328">(</span><span style="color:#cf222e">define </span><span style="color:#953800">foo2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#1f2328">(</span><span style="color:#cf222e">let </span><span style="color:#1f2328">((</span><span style="color:#6639ba">bar2</span> <span style="color:#1f2328">(</span><span style="color:#6639ba">/ </span><span style="color:#0550ae">5</span> <span style="color:#0550ae">2</span><span style="color:#1f2328">)))</span>    <span style="color:#57606a">; * evaluted immediately</span>
</span></span><span style="display:flex;"><span>            <span style="color:#1f2328">(</span><span style="color:#6639ba">newline</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#1f2328">(</span><span style="color:#6639ba">display </span><span style="color:#0a3069">&#34;let in `foo2`, bar2: &#34;</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#1f2328">(</span><span style="color:#6639ba">display </span><span style="color:#953800">bar2</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">)</span>
</span></span></code></pre></div><p>Running examples:</p>
<ul>
<li>
<p><code>foo1</code>: We can see that the <code>let</code> binding is evaluated, otherwise we wouldn&rsquo;t get a division by zero exception.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span><span style="color:#953800">prompt&gt;</span> <span style="color:#1f2328">(</span><span style="color:#6639ba">comp</span> <span style="color:#0550ae">4</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span><span style="color:#953800">else-clause</span>
</span></span><span style="display:flex;"><span><span style="color:#57606a">;Division by zero signalled by /.</span>
</span></span><span style="display:flex;"><span><span style="color:#57606a">;To continue, call RESTART with an option number:</span>
</span></span><span style="display:flex;"><span><span style="color:#57606a">;snip</span>
</span></span></code></pre></div></li>
<li>
<p><code>foo2</code>: We can see that the expressions after the <code>let</code> binding are evaluated, otherwise we wouldn&rsquo;t see the display output.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span><span style="color:#953800">prompt&gt;</span> <span style="color:#1f2328">(</span><span style="color:#6639ba">comp</span> <span style="color:#0550ae">2</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span><span style="color:#953800">then-clause</span>
</span></span><span style="display:flex;"><span><span style="color:#cf222e">let </span><span style="color:#953800">in</span> <span style="color:#0550ae">`</span><span style="color:#953800">foo2</span><span style="color:#0550ae">`,</span> <span style="color:#953800">bar2:</span> <span style="color:#0550ae">5</span><span style="color:#953800">/2</span>
</span></span><span style="display:flex;"><span><span style="color:#57606a">;Unspecified return value</span>
</span></span></code></pre></div></li>
</ul>
<h2 id="semantics-of-if"><a href="#semantics-of-if" class="header-anchor"></a>Semantics of <code>if</code>
</h2><p>The semantics of <code>if</code>: It evaluates the condition <strong>first</strong>, then decides whether to evaluate the then-clause or else-clause based on the result.</p>
<p>A good reference for this is SICP (2nd Edition) Exercise 1.6, where an abstraction is used to define <code>new-if</code> using <code>cond</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span><span style="color:#1f2328">(</span><span style="color:#cf222e">define </span><span style="color:#1f2328">(</span><span style="color:#6639ba">new-if</span> <span style="color:#953800">predicate</span> <span style="color:#953800">then-clause</span> <span style="color:#953800">else-clause</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#1f2328">(</span><span style="color:#cf222e">cond </span><span style="color:#1f2328">(</span><span style="color:#6639ba">predicate</span> <span style="color:#953800">then-clause</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>          <span style="color:#1f2328">(</span><span style="color:#cf222e">else </span><span style="color:#953800">else-clause</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#1f2328">)</span>   
</span></span><span style="display:flex;"><span><span style="color:#1f2328">)</span>
</span></span></code></pre></div><p>The semantics of function application (applicative order evaluation) requires evaluating arguments <strong>first</strong> (like then-clause and else-clause here) before applying the function. This is why you can&rsquo;t write recursive expressions in then-clause or else-clause - they would be evaluated regardless of the predicate&rsquo;s value, leading to infinite recursion. <code>if</code>/<code>cond</code>/&hellip; are <strong>special forms</strong> with different semantics compared to abstractions defined through <code>define</code>. I like the new-if example because it elegantly demonstrates Lisp&rsquo;s metaprogramming features. Following the substitution model, predicate, then-clause, and else-clause can be replaced with any expressions you need, where expressions are enclosed in parentheses - the parentheses mark expression boundaries, and you can put parenthesized expressions in any parameter position (as long as they satisfy the implicit type constraints of the abstraction).</p>
<h2 id="an-error-caused-by-immediate-let-evaluation"><a href="#an-error-caused-by-immediate-let-evaluation" class="header-anchor"></a>An Error Caused by Immediate <code>let</code> Evaluation
</h2><p>Consider this prime number checking code:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span><span style="color:#1f2328">(</span><span style="color:#cf222e">define </span><span style="color:#1f2328">(</span><span style="color:#6639ba">prime?</span> <span style="color:#953800">x</span><span style="color:#1f2328">)</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#1f2328">(</span><span style="color:#cf222e">if </span><span style="color:#1f2328">(</span><span style="color:#cf222e">or </span><span style="color:#1f2328">(</span><span style="color:#6639ba">= </span><span style="color:#953800">x</span> <span style="color:#0550ae">1</span><span style="color:#1f2328">)</span> <span style="color:#1f2328">(</span><span style="color:#6639ba">= </span><span style="color:#953800">x</span> <span style="color:#0550ae">2</span><span style="color:#1f2328">))</span>
</span></span><span style="display:flex;"><span>        <span style="color:#0550ae">#t</span>
</span></span><span style="display:flex;"><span>        <span style="color:#953800">test_prime</span>   
</span></span><span style="display:flex;"><span>    <span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#1f2328">(</span><span style="color:#cf222e">define </span><span style="color:#1f2328">(</span><span style="color:#6639ba">divisible?</span> <span style="color:#953800">y</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#1f2328">(</span><span style="color:#6639ba">= </span><span style="color:#0550ae">0</span> <span style="color:#1f2328">(</span><span style="color:#6639ba">remainder </span><span style="color:#953800">x</span> <span style="color:#953800">y</span><span style="color:#1f2328">))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>    <span style="color:#1f2328">(</span><span style="color:#cf222e">define </span><span style="color:#1f2328">(</span><span style="color:#6639ba">iter_biggest_divisor</span> <span style="color:#953800">y</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#1f2328">(</span><span style="color:#cf222e">cond </span><span style="color:#1f2328">((</span><span style="color:#6639ba">= </span><span style="color:#953800">y</span> <span style="color:#0550ae">1</span><span style="color:#1f2328">)</span> <span style="color:#0550ae">1</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>              <span style="color:#1f2328">((</span><span style="color:#6639ba">divisible?</span> <span style="color:#953800">y</span><span style="color:#1f2328">)</span> <span style="color:#953800">y</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>              <span style="color:#1f2328">(</span><span style="color:#cf222e">else </span><span style="color:#1f2328">(</span><span style="color:#6639ba">iter_biggest_divisor</span> <span style="color:#1f2328">(</span><span style="color:#6639ba">- </span><span style="color:#953800">y</span> <span style="color:#0550ae">1</span><span style="color:#1f2328">)))</span>
</span></span><span style="display:flex;"><span>        <span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#1f2328">(</span><span style="color:#cf222e">define </span><span style="color:#953800">test_prime</span>
</span></span><span style="display:flex;"><span>        <span style="color:#1f2328">(</span><span style="color:#cf222e">let </span><span style="color:#1f2328">((</span><span style="color:#6639ba">biggest_divisor</span> <span style="color:#1f2328">(</span><span style="color:#6639ba">iter_biggest_divisor</span> <span style="color:#1f2328">(</span><span style="color:#6639ba">quotient </span><span style="color:#953800">x</span> <span style="color:#0550ae">2</span><span style="color:#1f2328">))</span> <span style="color:#1f2328">))</span> <span style="color:#57606a">; Notice</span>
</span></span><span style="display:flex;"><span>             <span style="color:#1f2328">(</span><span style="color:#6639ba">display </span><span style="color:#953800">biggest_divisor</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>             <span style="color:#1f2328">(</span><span style="color:#cf222e">if </span><span style="color:#1f2328">(</span><span style="color:#6639ba">= </span><span style="color:#953800">biggest_divisor</span> <span style="color:#0550ae">1</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>                 <span style="color:#0550ae">#t</span>
</span></span><span style="display:flex;"><span>                 <span style="color:#0550ae">#f</span>
</span></span><span style="display:flex;"><span>             <span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">)</span>
</span></span></code></pre></div><p>The results when running:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span><span style="color:#953800">prompt&gt;</span> <span style="color:#1f2328">(</span><span style="color:#6639ba">prime?</span> <span style="color:#0550ae">1</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57606a">;The object 0, passed as the second argument to integer-remainder, is not in the correct range.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#953800">prompt&gt;</span> <span style="color:#1f2328">(</span><span style="color:#6639ba">prime?</span> <span style="color:#0550ae">2</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span><span style="color:#0550ae">1</span>
</span></span><span style="display:flex;"><span><span style="color:#57606a">;Value: #t</span>
</span></span></code></pre></div><p>According to programmers&rsquo; expectations, both <code>(prime? 1)</code> and <code>(prime? 2)</code> should directly return <code>#t</code>, rather than the former throwing an error and the latter showing the behavior of <code>(display biggest_divisor)</code>. As stated earlier, this occurs because the entire <code>let</code> scope is evaluated immediately.</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/sicp/">SICP</a>
        
            <a href="/tags/scheme/">Scheme</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.body, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/message-passing-perspective-on-bool-sicp-2.4.3-generic-data-and-functions/">
        
        

        <div class="article-details">
            <h2 class="article-title">Message Passing Perspective on Bool - SICP Â§ 2.4.3 | Generic | Data and Functions</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/mit-scheme-basic-usage/">
        
        

        <div class="article-details">
            <h2 class="article-title">MIT-Scheme Basic Usage</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/church-encoding-note/">
        
        

        <div class="article-details">
            <h2 class="article-title">Church Encoding Note</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/huffman-trees-in-haskell-structure-and-destructure-of-compound-data/">
        
        

        <div class="article-details">
            <h2 class="article-title">Huffman Trees in Haskell | Structure and Destructure of Compound Data</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/nested-mapping-examples-implemented-in-haskell-sicp-2.2.3-list-monad/">
        
        

        <div class="article-details">
            <h2 class="article-title">Nested Mapping Examples Implemented in Haskell - SICP Â§ 2.2.3  | List Monad </h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2024 - 
        
        2025 fyshXplore
    </section>
    
    <section class="powerby">
        
            Contact: hnu_yuxin@hnu.edu.cn <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.26.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

  
  
<script>
let currentIndex = 0;
const images = document.querySelectorAll('.image-container img');
const totalImages = images.length;


images[currentIndex].classList.add('active');

function moveSlide(step) {
    
    images[currentIndex].classList.remove('active');

    
    currentIndex = (currentIndex + step + totalImages) % totalImages;

    
    images[currentIndex].classList.add('active');
}
</script>
    

<script>
  
  const copyText = document.getElementById("copyText");
  const notification = document.getElementById("notification");

  
  copyText.addEventListener("click", function() {
    
    const tempInput = document.createElement("input");
    document.body.appendChild(tempInput);
    tempInput.value = copyText.innerText; 
    tempInput.select();
    document.execCommand("copy"); 
    document.body.removeChild(tempInput); 

    
    notification.classList.add("show");

    
    setTimeout(function() {
      notification.classList.remove("show");
    }, 2000);
  });
</script>
    </body>
</html>
